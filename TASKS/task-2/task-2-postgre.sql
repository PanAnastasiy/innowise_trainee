
CREATE OR REPLACE PROCEDURE test_2(
    p_param1 DATE,
    p_param2 TIMESTAMP,
    p_param3 DATE
)
    LANGUAGE plpgsql
AS $$
BEGIN
    -- Emmulate working
    RAISE NOTICE 'Make it with Strawberry';
    RAISE NOTICE 'Procedure test_2 executed with: %, %, %', p_param1, p_param2, p_param3;
END;
$$;

--🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓

-- Data for procudure
CREATE TEMP TABLE proc_params (
                                  param1 DATE,
                                  param2 TIMESTAMP,
                                  param3 DATE
);

INSERT INTO proc_params VALUES
                            ('2025-02-06','2025-02-12 09:38:25.999982000','2025-01-28'),
                            ('2025-02-14','2025-02-14 16:17:14.095384000','2025-02-06'),
                            ('2025-02-20','2025-02-21 08:41:53.643244000','2025-02-14'),
                            ('2025-02-25','2025-03-11 15:52:28.575590000','2025-02-20'),
                            ('2025-03-06','2025-03-13 15:35:21.729785000','2025-02-25'),
                            ('2025-03-13','2025-03-13 16:32:27.178218000','2025-03-06'),
                            ('2025-03-20','2025-03-26 08:35:19.585812000','2025-03-13'),
                            ('2025-03-27','2025-03-28 07:23:03.611707000','2025-03-20'),
                            ('2025-04-07','2025-04-08 18:57:03.804270000','2025-03-27'),
                            ('2025-04-10','2025-04-15 11:19:51.275211000','2025-04-07'),
                            ('2025-04-14','2025-04-15 14:34:32.097939000','2025-04-10'),
                            ('2025-04-24','2025-04-24 14:41:48.705573000','2025-04-14'),
                            ('2025-05-02','2025-05-08 11:05:44.640510000','2025-04-24'),
                            ('2025-05-15','2025-05-21 10:00:08.361011000','2025-05-02'),
                            ('2025-05-22','2025-05-28 08:07:06.096731000','2025-05-15'),
                            ('2025-05-29','2025-05-30 10:01:45.906511000','2025-05-22'),
                            ('2025-06-05','2025-06-09 09:22:04.668390000','2025-05-29'),
                            ('2025-06-19','2025-07-03 08:27:40.115104000','2025-06-05'),
                            ('2025-06-26','2025-07-03 09:15:38.292950000','2025-06-19'),
                            ('2025-07-03','2025-07-07 10:53:30.915895000','2025-06-26');

--🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓

-- Anonymous code block for a check
DO $$
    DECLARE
        rec RECORD;
    BEGIN
        FOR rec IN SELECT param1, param2, param3 FROM proc_params
            LOOP
                CALL test_2(rec.param1, rec.param2, rec.param3);
            END LOOP;
    END $$;