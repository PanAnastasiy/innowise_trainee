
-- Тут, чтобы проверить, вызовы использовал функцию, а не процедуру.
-- В Snowflake SQL-процедуры выполняются на сервере и
-- не имеют прямого канала для печати текста в клиентскую консоль, облачная СУБД...

CREATE OR REPLACE FUNCTION TEST_2(
    P_PARAM1 DATE,
    P_PARAM2 TIMESTAMP,
    P_PARAM3 DATE
)
    RETURNS VARCHAR
    LANGUAGE SQL
AS
$$
    -- Emmulate working
    'TEST_2 executed with: ' || P_PARAM1 || ', ' || P_PARAM2 || ', ' || P_PARAM3
$$;


--🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓

-- Data for function
CREATE OR REPLACE TEMPORARY TABLE PROC_PARAMS (
                                                  PARAM1 DATE,
                                                  PARAM2 TIMESTAMP,
                                                  PARAM3 DATE
);

INSERT INTO PROC_PARAMS (PARAM1, PARAM2, PARAM3) VALUES
                                                     ('2025-02-06','2025-02-12 09:38:25.999982000','2025-01-28'),
                                                     ('2025-02-14','2025-02-14 16:17:14.095384000','2025-02-06'),
                                                     ('2025-02-20','2025-02-21 08:41:53.643244000','2025-02-14'),
                                                     ('2025-02-25','2025-03-11 15:52:28.575590000','2025-02-20'),
                                                     ('2025-03-06','2025-03-13 15:35:21.729785000','2025-02-25'),
                                                     ('2025-03-13','2025-03-13 16:32:27.178218000','2025-03-06'),
                                                     ('2025-03-20','2025-03-26 08:35:19.585812000','2025-03-13'),
                                                     ('2025-03-27','2025-03-28 07:23:03.611707000','2025-03-20'),
                                                     ('2025-04-07','2025-04-08 18:57:03.804270000','2025-03-27'),
                                                     ('2025-04-10','2025-04-15 11:19:51.275211000','2025-04-07'),
                                                     ('2025-04-14','2025-04-15 14:34:32.097939000','2025-04-10'),
                                                     ('2025-04-24','2025-04-24 14:41:48.705573000','2025-04-14'),
                                                     ('2025-05-02','2025-05-08 11:05:44.640510000','2025-04-24'),
                                                     ('2025-05-15','2025-05-21 10:00:08.361011000','2025-05-02'),
                                                     ('2025-05-22','2025-05-28 08:07:06.096731000','2025-05-15'),
                                                     ('2025-05-29','2025-05-30 10:01:45.906511000','2025-05-22'),
                                                     ('2025-06-05','2025-06-09 09:22:04.668390000','2025-05-29'),
                                                     ('2025-06-19','2025-07-03 08:27:40.115104000','2025-06-05'),
                                                     ('2025-06-26','2025-07-03 09:15:38.292950000','2025-06-19'),
                                                     ('2025-07-03','2025-07-07 10:53:30.915895000','2025-06-26');


--🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓🍓

-- SELECT-query code block for a check
SELECT TEST_2(PARAM1, PARAM2, PARAM3) AS MESSAGE
FROM PROC_PARAMS
ORDER BY PARAM1;
